<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HATE Studio - –§–∏–ª—å–º</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüé¨%3C/text%3E%3C/svg%3E" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Mobile menu styles */
        #main-nav.mobile-nav-visible {
            transform: translateX(0);
        }
        /* Notifications */
        .notification {
            transition: all 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col">

    <header class="bg-gray-800 shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex items-center justify-between">
            <a href="index.html" class="text-2xl font-bold text-orange-500">HATE Studio</a>
            
            <nav id="main-nav-desktop" class="hidden md:flex items-center space-x-6">
                <a href="index.html" class="text-white hover:text-orange-500 transition-colors">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="films.html" class="text-white hover:text-orange-500 transition-colors">–§–∏–ª—å–º—ã</a>
                <a href="series.html" class="text-white hover:text-orange-500 transition-colors">–°–µ—Ä–∏–∞–ª—ã</a>
                <a href="bookmarks.html" id="desktop-bookmarks-link" class="text-white hover:text-orange-500 transition-colors hidden">–ó–∞–∫–ª–∞–¥–∫–∏</a>
                <a href="users.html" id="desktop-users-link" class="text-white hover:text-orange-500 transition-colors hidden">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
            </nav>

            <div class="flex items-center space-x-4">
                <a href="login.html" id="login-btn-desktop" class="bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors hidden md:block">–í–æ–π—Ç–∏</a>
                
                <div id="profile-dropdown-container" class="relative hidden">
                    <button id="profile-link-desktop" class="flex items-center space-x-2 text-white hover:text-orange-500 transition-colors">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" fill-rule="evenodd"></path></svg>
                    </button>
                    <div id="profile-dropdown" class="absolute right-0 mt-2 w-48 bg-gray-700 rounded-md shadow-lg py-1 hidden">
                        <a href="profile.html" class="block px-4 py-2 text-sm text-white hover:bg-gray-600">–ü—Ä–æ—Ñ–∏–ª—å</a>
                        <a href="#" id="logout-btn-desktop" class="block px-4 py-2 text-sm text-red-400 hover:bg-gray-600">–í—ã—Ö–æ–¥</a>
                    </div>
                </div>

                <button id="logout-btn-desktop" class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors hidden">–í—ã—Ö–æ–¥</button>
                
                <button id="mobile-menu-button" class="md:hidden text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <nav id="main-nav" class="fixed top-0 right-0 h-full w-64 bg-gray-800 shadow-xl z-50 transform translate-x-full transition-transform duration-300 md:hidden">
        <div class="p-4 flex flex-col space-y-4">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-orange-500">–ú–µ–Ω—é</h2>
                <button id="close-mobile-menu-btn" class="text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <a href="index.html" class="text-white hover:text-orange-500 transition-colors">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="films.html" class="text-white hover:text-orange-500 transition-colors">–§–∏–ª—å–º—ã</a>
            <a href="series.html" class="text-white hover:text-orange-500 transition-colors">–°–µ—Ä–∏–∞–ª—ã</a>
            <a href="bookmarks.html" id="mobile-bookmarks-link" class="text-white hover:text-orange-500 transition-colors hidden">–ó–∞–∫–ª–∞–¥–∫–∏</a>
            <a href="users.html" id="mobile-users-link" class="text-white hover:text-orange-500 transition-colors hidden">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
            <hr class="border-gray-700">
            <a href="profile.html" id="profile-link" class="text-white hover:text-orange-500 transition-colors hidden">–ü—Ä–æ—Ñ–∏–ª—å</a>
            <a href="login.html" id="login-btn" class="bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors text-center">–í–æ–π—Ç–∏</a>
            <button id="logout-btn" class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors text-center hidden">–í—ã—Ö–æ–¥</button>
        </div>
    </nav>
    <div id="mobile-menu-backdrop" class="fixed inset-0 bg-black opacity-50 z-40 hidden md:hidden"></div>
    
    <div id="notification-container" class="fixed bottom-0 right-0 p-4 z-50 pointer-events-none"></div>

    <main class="container mx-auto px-4 py-8 flex-grow">
        
        <div id="content-details" class="bg-gray-800 p-6 rounded-xl shadow-2xl">
            </div>

        <div id="comments-section" class="mt-10">
            <h2 class="text-3xl font-bold text-white mb-6">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h2>
            <div class="bg-gray-800 p-6 rounded-xl">
                <p class="text-gray-400">–°–µ–∫—Ü–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –∏–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.</p>
            </div>
        </div>

    </main>

    <footer class="bg-gray-800 mt-10">
        <div class="container mx-auto px-4 py-6 text-center text-gray-400">
            <p>&copy; 2024 HATE Studio. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
    </footer>

    <script type="module" src="./firebase-config.js"></script>
    <script type="module" src="./app.js"></script>
    
    <script>
        // === –õ–û–ì–ò–ö–ê –î–õ–Ø film-page.html ===

        // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ app.js, –Ω–æ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã film-page.html –æ–Ω–∞ –Ω—É–∂–Ω–∞ –∑–¥–µ—Å—å,
        // —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
        const loadContentDetails = async (contentId) => {
            const contentDetailsEl = document.getElementById('content-details');
            if (!contentDetailsEl) return;

            const { getDoc, doc, db } = await import("https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js");
            
            try {
                const docSnap = await getDoc(doc(db, 'content', contentId));

                if (docSnap.exists()) {
                    const data = docSnap.data();
                    let videoPlayerHtml = '';

                    if (data.type === 'film' && data.videoUrl) {
                        // –ü–ª–µ–µ—Ä –¥–ª—è —Ñ–∏–ª—å–º–∞
                        videoPlayerHtml = `<div class="aspect-w-16 aspect-h-9 mb-6">
                            <iframe src="${data.videoUrl}" class="w-full h-96 rounded-lg" frameborder="0" allowfullscreen></iframe>
                        </div>`;
                    } else if (data.type === 'series' && data.seasons && data.seasons.length > 0) {
                        // –õ–æ–≥–∏–∫–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–µ–∑–æ–Ω–∞/—Å–µ—Ä–∏–∏ (–º–æ–∂–Ω–æ —É—Å–ª–æ–∂–Ω–∏—Ç—å –ø–æ–∑–∂–µ, –ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞)
                        const firstEpisodeUrl = data.seasons[0]?.episodes[0]?.videoUrl || '';
                        if (firstEpisodeUrl) {
                            videoPlayerHtml = `<div class="aspect-w-16 aspect-h-9 mb-6">
                                <iframe src="${firstEpisodeUrl}" class="w-full h-96 rounded-lg" frameborder="0" allowfullscreen></iframe>
                            </div>
                            <p class="text-gray-400 mb-4">–°–µ—Ä–∏–∞–ª: ${data.seasons.length} —Å–µ–∑–æ–Ω–æ–≤. (–ü–ª–µ–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—É—é —Å–µ—Ä–∏—é)</p>`;
                        } else {
                            videoPlayerHtml = `<p class="text-yellow-500 mb-4">–í–Ω–∏–º–∞–Ω–∏–µ: –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–∏–π/–≤–∏–¥–µ–æ URL.</p>`;
                        }
                    }

                    contentDetailsEl.innerHTML = `
                        ${videoPlayerHtml}
                        <div class="flex flex-col md:flex-row gap-6">
                            <div class="md:w-1/3">
                                <img src="${data.posterUrl}" alt="${data.title}" class="w-full h-auto rounded-lg shadow-xl object-cover">
                            </div>
                            <div class="md:w-2/3">
                                <h1 class="text-4xl font-extrabold text-orange-500 mb-4">${data.title}</h1>
                                <div class="flex items-center space-x-4 mb-4">
                                    <span class="bg-gray-700 text-white text-sm font-semibold px-3 py-1 rounded-full">${data.type === 'film' ? '–§–∏–ª—å–º' : '–°–µ—Ä–∏–∞–ª'}</span>
                                    <span class="text-xl font-bold text-yellow-400">‚≠ê ${data.rating || '0.0'}</span>
                                    <button id="bookmark-btn" class="flex items-center justify-center space-x-2 px-6 py-3 rounded-lg font-bold transition-colors text-white bg-gray-700 hover:bg-gray-600">
                                        –ó–∞–≥—Ä—É–∑–∫–∞...
                                    </button>
                                </div>
                                <h2 class="text-2xl font-semibold text-white mb-2">–û–ø–∏—Å–∞–Ω–∏–µ</h2>
                                <p class="text-gray-300 leading-relaxed mb-4">${data.description}</p>
                            </div>
                        </div>
                    `;
                } else {
                    contentDetailsEl.innerHTML = `<p class="text-red-500 text-xl">–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.</p>`;
                }
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:", error);
                contentDetailsEl.innerHTML = `<p class="text-red-500 text-xl">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö: ${error.message}</p>`;
            }
        };

        const loadFilmData = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const contentId = urlParams.get('id');
            if (contentId) {
                loadContentDetails(contentId);
            } else {
                document.getElementById('content-details').innerHTML = `<p class="text-red-500 text-xl">–ù–µ —É–∫–∞–∑–∞–Ω ID –∫–æ–Ω—Ç–µ–Ω—Ç–∞.</p>`;
            }
        };

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        document.addEventListener('DOMContentLoaded', loadFilmData);
    </script>
</body>
</html>
